
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.4. Functional Programming &#8212; Phlex 0 (60d5329) documentation</title>
    <link rel="stylesheet" type="text/css" href="../static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../static/phlexframework.css?v=d0378a82" />
    <link rel="stylesheet" type="text/css" href="../static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-data-viewer/jsonview.bundle.css?v=f6ef2277" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/libs/html/datatables.min.css?v=4b4fd840" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/common_css/needstable.css?v=5e1b6797" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/common_css/need_toggle.css?v=5c6620df" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/common_css/need_links.css?v=2150a916" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/common_css/need_core.css?v=f5b60a78" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/common_css/need_style.css?v=92936fa5" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/modern.css?v=803738c0" />
    
    <script src="../static/jquery.js?v=5d32c60e"></script>
    <script src="../static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../static/documentation_options.js?v=209ff22c"></script>
    <script src="../static/doctools.js?v=9bcbadda"></script>
    <script src="../static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../static/sphinx-data-viewer/jsonview.bundle.js?v=18cd53c5"></script>
    <script src="../static/sphinx-data-viewer/jsonview_loader.js?v=f7ff7e7d"></script>
    <script src="../static/sphinx-needs/libs/html/datatables.min.js?v=8a4aee21"></script>
    <script src="../static/sphinx-needs/libs/html/datatables_loader.js?v=a2cae175"></script>
    <script src="../static/sphinx-needs/libs/html/sphinx_needs_collapse.js?v=dca66431"></script>
    <script>window.MathJax = {"loader": {"load": ["[tex]/newcommand", "[tex]/textmacros"]}, "tex": {"packages": {"[+]": ["newcommand", "textmacros"]}, "macros": {"one": ["\\Bbb{1}", 0], "transform": ["\\textrm{transform}(#1)", 1], "predicate": ["\\textrm{predicate}(#1)", 1], "filter": ["\\textrm{filter}(#1)", 1], "observe": ["\\textrm{observe}(#1)", 1], "unfold": ["\\textrm{unfold}(#1, #2)", 2], "punfold": ["\\textrm{unfold}(#1, #2, #3)", 3], "fold": ["\\textrm{fold}(#1, #2)", 2], "pfold": ["\\textrm{fold}(#1, #2, #3)", 3], "iset": ["\\mathcal{I}_{#1}", 1], "sequence": ["\\left[#1_i\\right]_{i \\in \\mathcal{I}}", 1], "isequence": ["\\left[#1_i\\right]_{i \\in \\mathcal{I}_{#2}}", 2], "comp": ["\\circ", 0]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.6. Data Flow" href="data_flow.html" />
    <link rel="prev" title="2.3. Sequences" href="sequences.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="data_flow.html" title="2.6. Data Flow"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sequences.html" title="2.3. Sequences"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Phlex 0 (60d5329) documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../preliminaries.html" accesskey="U"><span class="section-number">2. </span>Preliminaries</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2.4. </span>Functional Programming</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="functional-programming">
<h1><span class="section-number">2.4. </span>Functional Programming<a class="headerlink" href="#functional-programming" title="Link to this heading">¶</a></h1>
<p>Functional programming is a paradigm that favors the use of <em>functions</em> instead of the direct manipulation of stateful objects.
The processing of data happens by using chained operations, where the output of one function serves as the input to other functions.</p>
<p>For example, given two functions:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}f: \mbox{Wires} \rightarrow \mbox{Hits}\\g: \mbox{Hits} \rightarrow \mbox{Tracks}\end{aligned}\end{align} \]</div>
<p>a composite function <span class="math notranslate nohighlight">\(h: \mbox{Wires} \rightarrow \mbox{Tracks}\)</span> can be constructed such that:</p>
<div class="math notranslate nohighlight">
\[ts = h\ ws = g\ (f\ ws) = (g \comp f)\ ws\]</div>
<p>or <span class="math notranslate nohighlight">\(h = g \comp f\)</span>, where <span class="math notranslate nohighlight">\(ws \in \mbox{Wires}\)</span> and <span class="math notranslate nohighlight">\(ts \in \mbox{Tracks}\)</span>.</p>
<p>In reality, the creation of tracks from wire signals is much more complicated <a class="footnote-reference brackets" href="#graph" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.
However, as seen above, functional programming permits a mathematical description of the data-processing to be performed.
Expressing the processing needs according to mathematics enables:</p>
<ul class="simple">
<li><p>the use of mathematical rules to optimize the processing of the data,</p></li>
<li><p>naturally reproducible results, assuming the functions are pure (see <a class="reference internal" href="#pure-functions"><span class="std std-numref">Section 2.4.1</span></a>),</p></li>
<li><p>parallel invocations of pure functions with no possibility of data races <a class="reference internal" href="../appendices/requirements.html#DUNE 130" title="DUNE 130"><em class="xref need">[DUNE 130]</em></a>.</p></li>
</ul>
<section id="pure-functions">
<h2><span class="section-number">2.4.1. </span>Pure Functions<a class="headerlink" href="#pure-functions" title="Link to this heading">¶</a></h2>
<p>According to Wikipedia <a class="reference internal" href="#wiki-pure" id="id2"><span>[Wiki-pure]</span></a>, a pure function has the following properties:</p>
<ul class="simple">
<li><p>the function return values are identical for identical arguments, and</p></li>
<li><p>the function has no side effects.</p></li>
</ul>
<p>The composition of pure functions is also a pure function.
For example, assuming the functions <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> above are pure, then the composite function <span class="math notranslate nohighlight">\(h\)</span> will also be pure.</p>
<p>Using pure functions to create data products ensures <a class="reference internal" href="../appendices/definitions.html#term-Reproducible"><span class="xref std std-term">reproducibility</span></a>, as discussed in the framework philosophy in <a class="reference internal" href="../introduction.html#framework-philosophy"><span class="std std-numref">Section 1.2</span></a>.</p>
</section>
<section id="difficulties-with-functional-programming">
<h2><span class="section-number">2.4.2. </span>Difficulties with Functional Programming<a class="headerlink" href="#difficulties-with-functional-programming" title="Link to this heading">¶</a></h2>
<p>One drawback to functional programming is that it differs from what many in the HEP community are accustomed to when writing their own physics algorithms.
Commonly used third-party libraries and computing languages can also make functional programming difficult to use in practice.
We argue, though, that physicists often think in terms of functional programming when developing the high-level processing steps of a workflow.
It is not until those processing steps need to be implemented that the functional steps are translated into a different programming paradigm (often <em>procedural</em>).</p>
<p>Phlex aims to restore the functional programming approach as the natural way of expressing the data-processing to be performed.
By leveraging commonly used processing patterns (see <a class="reference internal" href="#sequences-of-data-and-higher-order-functions"><span class="std std-numref">Section 2.5</span></a> on higher-order functions), we can mitigate any awkwardness due to initial unfamiliarity with functional programming paradigms.
The framework also does not place constraints on the algorithm <em>implementations</em>—algorithm authors are free to employ imperative programming techniques within the implementations if doing so is convenient.
The framework will simply schedule the algorithm as if it were a pure function without regard to its implementation.</p>
</section>
</section>
<section id="sequences-of-data-and-higher-order-functions">
<h1><span class="section-number">2.5. </span>Sequences of Data and Higher-Order Functions<a class="headerlink" href="#sequences-of-data-and-higher-order-functions" title="Link to this heading">¶</a></h1>
<p>Particle physics results are obtained by performing statistical analysis on sequences of data.
Such analysis typically involves repeated invocations of the same kind of operation.
For example, a relatively simple result is calculating the arithmetic mean of <span class="math notranslate nohighlight">\(n\)</span> numbers:</p>
<div class="math notranslate nohighlight">
\[\overline{c} = \frac{1}{n}\sum_{i \in \mathcal{I}} c_i\]</div>
<p>where the sum is over a sequence of numbers <span class="math notranslate nohighlight">\(\sequence{c}\)</span>, and <span class="math notranslate nohighlight">\(n\)</span> is the size or <em>cardinality</em> of the index set <span class="math notranslate nohighlight">\(\mathcal{I}\)</span> (e.g. <span class="math notranslate nohighlight">\(\{1, 2, \dots, n\}\)</span>) used to identify each element of the sequence.</p>
<p>The sum is an example of a data reduction or <em>fold</em>, where a sequence is collapsed into one result.
In particular, the arithmetic mean above can be expressed as:</p>
<div class="math notranslate nohighlight">
\[\overline{c} = \frac{1}{n}\ \fold{+}{0}\ \sequence{c}\]</div>
<p>where the fold accepts a binary operator (<span class="math notranslate nohighlight">\(+\)</span> in this case) that is repeatedly applied to an accumulated value (initialized to 0) and each element of the sequence.</p>
<p>The fold is an example of a <em>higher-order function</em> (HOF) <a class="reference internal" href="#wiki-hof" id="id3"><span>[Wiki-hof]</span></a> that accepts a sequence and an operator applied in some way to elements of that sequence.</p>
<p>Additional HOFs exist—for example, suppose the sequence <span class="math notranslate nohighlight">\([c_i]\)</span> was created by applying a function <span class="math notranslate nohighlight">\(w: E \rightarrow C\)</span> to each element of a sequence <span class="math notranslate nohighlight">\([e_i]\)</span>.
Such a HOF is called a map or <em>transform</em>:</p>
<div class="math notranslate nohighlight">
\[\sequence{c} = \sequence{w\ e} = \transform{w}\ \sequence{e}\]</div>
<p>In such a scenario, the average <span class="math notranslate nohighlight">\(\overline{c}\)</span> could be expressed as:</p>
<div class="math notranslate nohighlight">
\[\overline{c} = \frac{1}{n}\ \fold{+}{0}\ \transform{w}\ \sequence{e} = \frac{1}{n}\ \fold{+ \comp w}{0}\ \sequence{e}\]</div>
<p>The second equality holds by the fold-map fusion law <a class="reference internal" href="#bird" id="id4"><span>[Bird]</span></a>, which states that the application of a <span class="math notranslate nohighlight">\(\text{transform}\)</span> followed by a <span class="math notranslate nohighlight">\(\text{fold}\)</span> can be reduced to a single <span class="math notranslate nohighlight">\(\text{fold}\)</span>.
The operator to this single fold is ‘<span class="math notranslate nohighlight">\(+ \comp w\)</span>’, indicating that the function <span class="math notranslate nohighlight">\(w\)</span> should be applied first before invoking the <span class="math notranslate nohighlight">\(+\)</span> operation.
Relying on such mathematical laws permits the replacement of chained calculations with a single calculation, often leading to efficiency improvements without affecting the result.</p>
<p>A calculation is then generally expressed in terms of:</p>
<ol class="arabic simple">
<li><p>The HOFs to be used (<span class="math notranslate nohighlight">\(\mbox{fold}\)</span>, <span class="math notranslate nohighlight">\(\mbox{transform}\)</span>, etc.)</p></li>
<li><p>The operation to be used by each HOF (<span class="math notranslate nohighlight">\(+\)</span>, <span class="math notranslate nohighlight">\(w\)</span>, etc.)</p></li>
<li><p>The sequence(s) of data on which the HOFs are to be applied.</p></li>
</ol>
<p>Such a formulation lends itself to well-established processing patterns that can be naturally factorized and parallelized.</p>
<p><a class="reference internal" href="#hofs-in-phlex"><span class="std std-numref">Table 2.2</span></a> lists the HOFs supported by Phlex.
As discussed later, each HOF’s <em>operator</em> is an <a class="reference internal" href="../appendices/definitions.html#term-Algorithm"><span class="xref std std-term">algorithm</span></a> registered with the framework.
Phlex will likely support other higher order functions as well.</p>
<span id="hofs-in-phlex"></span><table class="docutils align-default" id="id5">
<caption><span class="caption-number">Table 2.2 </span><span class="caption-text">Higher-order functions supported by Phlex.
        Each sequence is represented by a single variable (e.g. <span class="math notranslate nohighlight">\(a\)</span>).
        Details of each HOF and its operators are in <a class="reference internal" href="../ch_conceptual_design/supported_hofs.html#supported-higher-order-functions"><span class="std std-numref">Section 3.5</span></a>.</span><a class="headerlink" href="#id5" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 15.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
<col style="width: 25.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p><strong>Higher-order function</strong></p></th>
<th class="head"><p>Operator(s)</p></th>
<th class="head"><p>Output sequence length</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../ch_conceptual_design/hofs/transforms.html#transforms"><span class="std std-ref">Transform</span></a></p></td>
<td><p><span class="math notranslate nohighlight">\(b = \transform{f}\ a\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f: A \rightarrow B\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(|b| = |a|\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../ch_conceptual_design/hofs/filters.html#filters-and-predicates"><span class="std std-ref">Filter</span></a></p></td>
<td><p><span class="math notranslate nohighlight">\(a' = \filter{p}\ a\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p: A \rightarrow \text{Boolean}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(|a'| \le |a|\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../ch_conceptual_design/hofs/observers.html#observers"><span class="std std-ref">Observer</span></a></p></td>
<td><p><span class="math notranslate nohighlight">\([\ \ ] = \observe{f}\ a\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f: A \rightarrow \one\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><p><a class="reference internal" href="../ch_conceptual_design/hofs/partitioned_folds.html#partitioned-folds"><span class="std std-ref">Fold</span></a></p></td>
<td rowspan="3"><p><span class="math notranslate nohighlight">\(d = \pfold{f}{init}{part}\ c\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f: D \times C \rightarrow D\)</span></p></td>
<td rowspan="3"><p><span class="math notranslate nohighlight">\(|d| \le |c|\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(init: \one \rightarrow D\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(part: \{\iset{c}\} \rightarrow \mathbb{P}(\iset{c})\)</span></p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p><a class="reference internal" href="../ch_conceptual_design/hofs/partitioned_unfolds.html#partitioned-unfolds"><span class="std std-ref">Unfold</span></a></p></td>
<td rowspan="3"><p><span class="math notranslate nohighlight">\(c = \punfold{p}{gen}{cat}\ d\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p: D \rightarrow \mbox{Boolean}\)</span></p></td>
<td rowspan="3"><p><span class="math notranslate nohighlight">\(|c| \ge |d|\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(gen: D \rightarrow D \times C\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(cat: \one \rightarrow L\)</span></p></td>
</tr>
</tbody>
</table>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="graph" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>As discussed in <a class="reference internal" href="data_flow.html#data-flow"><span class="std std-numref">Section 2.6</span></a>, the general topology of a data-processing workflow is a <em>graph</em> of functions.</p>
</aside>
</aside>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="wiki-pure" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Wiki-pure</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Pure_function">https://en.wikipedia.org/wiki/Pure_function</a></p>
</div>
<div class="citation" id="wiki-hof" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">Wiki-hof</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Higher-order_function">https://en.wikipedia.org/wiki/Higher-order_function</a></p>
</div>
<div class="citation" id="bird" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">Bird</a><span class="fn-bracket">]</span></span>
<p>Bird, Introduction to Functional Programming using Haskell (2nd ed.), Prentice Hall (1988), pp. 131–132</p>
</div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../static/phlex-logo.svg" alt="Logo of Phlex"/>
            </a></p>
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">2.4. Functional Programming</a><ul>
<li><a class="reference internal" href="#pure-functions">2.4.1. Pure Functions</a></li>
<li><a class="reference internal" href="#difficulties-with-functional-programming">2.4.2. Difficulties with Functional Programming</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sequences-of-data-and-higher-order-functions">2.5. Sequences of Data and Higher-Order Functions</a></li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="sequences.html"
                          title="previous chapter"><span class="section-number">2.3. </span>Sequences</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="data_flow.html"
                          title="next chapter"><span class="section-number">2.6. </span>Data Flow</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../sources/ch_preliminaries/functional_programming.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="data_flow.html" title="2.6. Data Flow"
             >next</a> |</li>
        <li class="right" >
          <a href="sequences.html" title="2.3. Sequences"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Phlex 0 (60d5329) documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../preliminaries.html" ><span class="section-number">2. </span>Preliminaries</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2.4. </span>Functional Programming</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Fermi Forward Discovery Group, LLC.
      Last updated on Jun 24, 2025.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>