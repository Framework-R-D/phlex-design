
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.7. Data-Product Providers &#8212; Phlex 0.4.alpha (7441d26) documentation</title>
    <link rel="stylesheet" type="text/css" href="../static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../static/phlexframework.css?v=47741a9d" />
    <link rel="stylesheet" type="text/css" href="../static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-data-viewer/jsonview.bundle.css?v=f6ef2277" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/libs/html/datatables.min.css?v=4b4fd840" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/common_css/need_toggle.css?v=5c6620df" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/common_css/needstable.css?v=5e1b6797" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/common_css/need_core.css?v=f5b60a78" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/common_css/need_links.css?v=2150a916" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/common_css/need_style.css?v=92936fa5" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-needs/modern.css?v=803738c0" />
    
    <script src="../static/jquery.js?v=5d32c60e"></script>
    <script src="../static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../static/documentation_options.js?v=7602de08"></script>
    <script src="../static/doctools.js?v=9bcbadda"></script>
    <script src="../static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../static/sphinx-data-viewer/jsonview.bundle.js?v=18cd53c5"></script>
    <script src="../static/sphinx-data-viewer/jsonview_loader.js?v=f7ff7e7d"></script>
    <script src="../static/sphinx-needs/libs/html/datatables.min.js?v=8a4aee21"></script>
    <script src="../static/sphinx-needs/libs/html/datatables_loader.js?v=a2cae175"></script>
    <script src="../static/sphinx-needs/libs/html/sphinx_needs_collapse.js?v=dca66431"></script>
    <script>window.MathJax = {"loader": {"load": ["[tex]/newcommand", "[tex]/textmacros", "[tex]/mathtools"]}, "tex": {"packages": {"[+]": ["newcommand", "textmacros", "mathtools"]}, "macros": {"bool": ["\\mathbb{B}", 0], "one": ["\\Bbb{1}", 0], "opt": ["\\text{Opt}(#1)", 1], "transform": ["\\textrm{transform}(#1)", 1], "predicate": ["\\textrm{predicate}(#1)", 1], "filter": ["\\textrm{filter}(#1)", 1], "observe": ["\\textrm{observe}(#1)", 1], "unfold": ["\\textrm{unfold}(#1, #2)", 2], "punfold": ["\\textrm{unfold}(#1, #2, #3)", 3], "fold": ["\\textrm{fold}(#1, #2)", 2], "pfold": ["\\textrm{fold}(#1, #2, #3)", 3], "window": ["\\textrm{window}(#1, #2, #3)", 3], "isetdefault": ["\\mathcal{I}", 0], "iset": ["\\isetdefault_{#1}", 1], "fami": ["\\left[#1_i\\right]", 1], "family": ["\\left[#1_i\\right]_{i \\in \\isetdefault}", 1], "ifamily": ["\\left[#1_i\\right]_{i \\in \\iset{#2}}", 2], "comp": ["\\circ", 0]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.8. Data-Product Preservers" href="preservers.html" />
    <link rel="prev" title="3.6. Framework Driver" href="driver.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="preservers.html" title="3.8. Data-Product Preservers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="driver.html" title="3.6. Framework Driver"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Phlex 0.4.alpha (7441d26) documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../conceptual_design.html" accesskey="U"><span class="section-number">3. </span>Conceptual Design</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.7. </span>Data-Product Providers</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="data-product-providers">
<h1><span class="section-number">3.7. </span>Data-Product Providers<a class="headerlink" href="#data-product-providers" title="Link to this heading">¶</a></h1>
<p>Data-product providers are framework components that provide data products to downstream configured HOFs.
They take as input data cell indices.
A provider invokes a user-supplied <em>provider algorithm</em>.</p>
<p>Some provider algorithms communicate with the IO system through a specified API that is implemented by each IO back end.
Providers communicate with the IO system only through this API.
This allows the framework to support multiple IO back ends, including ROOT <a class="reference internal" href="../appendices/requirements.html#DUNE 74" title="DUNE 74"><em class="xref need">[DUNE 74]</em></a> and HDF5 <a class="reference internal" href="../appendices/requirements.html#DUNE 141" title="DUNE 141"><em class="xref need">[DUNE 141]</em></a>, and ensure that new back ends can be added without modifying the framework code <a class="reference internal" href="../appendices/requirements.html#DUNE 73" title="DUNE 73"><em class="xref need">[DUNE 73]</em></a>.</p>
<p>Providers are responsible for reading data written by earlier code versions, subject to policy decisions made by the experiment <a class="reference internal" href="../appendices/requirements.html#DUNE 76" title="DUNE 76"><em class="xref need">[DUNE 76]</em></a>.</p>
<p>Providers are also responsible for reading some types of data (such as calibration data, or geometry descriptions) from sources other than files written by the IO system.
The workflow shown in <a class="reference internal" href="../conceptual_design.html#workflow"><span class="std std-numref">Fig. 3.1</span></a> shows an example of one such <em>provider</em> algorithm, which reads geometry data from a GDML file.</p>
<section id="provider-characteristics">
<h2><span class="section-number">3.7.1. </span>Provider Characteristics<a class="headerlink" href="#provider-characteristics" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>On-demand evaluation</p></li>
<li><p>Automatic caching</p></li>
<li><p>External data sources</p></li>
<li><p>Purity and determinism</p></li>
<li><p>Single output per provider</p></li>
<li><p>Plugin architecture</p></li>
</ul>
</section>
<section id="provider-function-signature">
<h2><span class="section-number">3.7.2. </span>Provider Function Signature<a class="headerlink" href="#provider-function-signature" title="Link to this heading">¶</a></h2>
<p>The provider function take a data cell index as input and returns a data product.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">return_type</span><span class="w"> </span><span class="n">function_name</span><span class="p">(</span><span class="n">data_cell_index</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="code highlight c++ docutils literal highlight-c++"><span class="n">reurn_type</span></code> must model the created data-product type described in <a class="reference internal" href="algorithms.html#return-types"><span class="std std-numref">Section 3.3.2</span></a>.
Only a single data product can be returned by a provider function.</p>
</section>
<section id="provider-registration">
<h2><span class="section-number">3.7.3. </span>Provider Registration<a class="headerlink" href="#provider-registration" title="Link to this heading">¶</a></h2>
<p>To illustrate the how a provider function is registered with Phlex, we use the following class and function, which are presumably defined in some experiment libraries.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SimDepos</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">};</span>

<span class="n">SimDepos</span><span class="w"> </span><span class="nf">provide_sim_depos</span><span class="p">(</span><span class="n">data_cell_index</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p><strong>Provider function that returns SimDepos</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">PHLEX_REGISTER_PROVIDERS</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">s</span><span class="p">.</span><span class="n">provide</span><span class="p">(</span><span class="s">&quot;fake_sim_depos&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">provide_sim_depos</span><span class="p">,</span><span class="w"> </span><span class="n">concurrency</span><span class="o">::</span><span class="n">unlimited</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">output_product_suffixes</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Provider registration</strong></p>
<p>This registers a provider that inserts a <span class="math notranslate nohighlight">\(\textit{SimDepos}\)</span> data product into each data cell in the data layer indicated by the data cell index.
In this example, the data product suffix provided to <code class="code highlight c++ docutils literal highlight-c++"><span class="n">output_product_suffixes</span></code> is an empty string.
The same effect can be achieved by omitting the <code class="code highlight c++ docutils literal highlight-c++"><span class="n">output_product_suffixes</span></code> call entirely.</p>
<section id="i-o-system-integration">
<h3><span class="section-number">3.7.3.1. </span>I/O System Integration<a class="headerlink" href="#i-o-system-integration" title="Link to this heading">¶</a></h3>
<p>[How providers communicate with I/O backends]</p>
</section>
<section id="multiple-i-o-backend-support">
<h3><span class="section-number">3.7.3.2. </span>Multiple I/O Backend Support<a class="headerlink" href="#multiple-i-o-backend-support" title="Link to this heading">¶</a></h3>
<p>[ROOT, HDF5, and other backends as mentioned in requirements]</p>
</section>
<section id="non-file-data-sources">
<h3><span class="section-number">3.7.3.3. </span>Non-File Data Sources<a class="headerlink" href="#non-file-data-sources" title="Link to this heading">¶</a></h3>
<p>[Calibration data, geometry descriptions, external services]</p>
</section>
<section id="integration-with-data-hierarchy">
<h3><span class="section-number">3.7.3.4. </span>Integration with Data Hierarchy<a class="headerlink" href="#integration-with-data-hierarchy" title="Link to this heading">¶</a></h3>
<p>[How providers work with different hierarchical layers]</p>
</section>
<section id="provider-with-different-layers">
<h3><span class="section-number">3.7.3.5. </span>Provider with Different Layers<a class="headerlink" href="#provider-with-different-layers" title="Link to this heading">¶</a></h3>
<p>[Example showing multiple providers for different layers]</p>
</section>
</section>
<section id="requirements-mapping">
<h2><span class="section-number">3.7.4. </span>Requirements Mapping<a class="headerlink" href="#requirements-mapping" title="Link to this heading">¶</a></h2>
<p>[Cross-references to specific DUNE requirements mentioned in original text]</p>
<ul class="simple">
<li><p><a class="reference internal" href="../appendices/requirements.html#DUNE 73" title="DUNE 73"><em class="xref need">[DUNE 73]</em></a> - Supporting new I/O backends without framework modifications</p></li>
<li><p><a class="reference internal" href="../appendices/requirements.html#DUNE 74" title="DUNE 74"><em class="xref need">[DUNE 74]</em></a> - ROOT support</p></li>
<li><p><a class="reference internal" href="../appendices/requirements.html#DUNE 76" title="DUNE 76"><em class="xref need">[DUNE 76]</em></a> - Reading data from earlier code versions</p></li>
<li><p><a class="reference internal" href="../appendices/requirements.html#DUNE 141" title="DUNE 141"><em class="xref need">[DUNE 141]</em></a> - HDF5 support</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../static/phlex-logo.svg" alt="Logo of Phlex"/>
            </a></p>
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">3.7. Data-Product Providers</a><ul>
<li><a class="reference internal" href="#provider-characteristics">3.7.1. Provider Characteristics</a></li>
<li><a class="reference internal" href="#provider-function-signature">3.7.2. Provider Function Signature</a></li>
<li><a class="reference internal" href="#provider-registration">3.7.3. Provider Registration</a><ul>
<li><a class="reference internal" href="#i-o-system-integration">3.7.3.1. I/O System Integration</a></li>
<li><a class="reference internal" href="#multiple-i-o-backend-support">3.7.3.2. Multiple I/O Backend Support</a></li>
<li><a class="reference internal" href="#non-file-data-sources">3.7.3.3. Non-File Data Sources</a></li>
<li><a class="reference internal" href="#integration-with-data-hierarchy">3.7.3.4. Integration with Data Hierarchy</a></li>
<li><a class="reference internal" href="#provider-with-different-layers">3.7.3.5. Provider with Different Layers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements-mapping">3.7.4. Requirements Mapping</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="driver.html"
                          title="previous chapter"><span class="section-number">3.6. </span>Framework Driver</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="preservers.html"
                          title="next chapter"><span class="section-number">3.8. </span>Data-Product Preservers</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../sources/ch_conceptual_design/providers.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="preservers.html" title="3.8. Data-Product Preservers"
             >next</a> |</li>
        <li class="right" >
          <a href="driver.html" title="3.6. Framework Driver"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Phlex 0.4.alpha (7441d26) documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../conceptual_design.html" ><span class="section-number">3. </span>Conceptual Design</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.7. </span>Data-Product Providers</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Fermi Forward Discovery Group, LLC.
      Last updated on Feb 09, 2026.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>